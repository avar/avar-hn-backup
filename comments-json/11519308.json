{
  "by" : "avar",
  "id" : 11519308,
  "kids" : [ 11522890 ],
  "parent" : 11516283,
  "text" : "Okey, but prepere for some super-lame ad-hoc code. Also I was\nmisremembering about it handling multiple repos, in the one place\nwhere I have &gt;1 I just do that manually.<p>My .bashrc will run a bootstrap_work_dotfiles function when bash\nstarts: <a href=\"https:&#x2F;&#x2F;github.com&#x2F;avar&#x2F;dotfiles&#x2F;blob&#x2F;master&#x2F;.bashrc#L410\" rel=\"nofollow\">https:&#x2F;&#x2F;github.com&#x2F;avar&#x2F;dotfiles&#x2F;blob&#x2F;master&#x2F;.bashrc#L410</a><p>This then clones my ~&#x2F;g&#x2F;avar-dotfiles-work repo if I&#x27;m at work and it\nhasn&#x27;t been cloned:\n<a href=\"https:&#x2F;&#x2F;github.com&#x2F;avar&#x2F;dotfiles&#x2F;blob&#x2F;master&#x2F;.bashrc#L355\" rel=\"nofollow\">https:&#x2F;&#x2F;github.com&#x2F;avar&#x2F;dotfiles&#x2F;blob&#x2F;master&#x2F;.bashrc#L355</a><p>I have a &quot;dud&quot; function (dotfile update) function that&#x27;ll update both,\nit basically does a git pull, re-chmods ~&#x2F;.ssh&#x2F;config:\n<a href=\"https:&#x2F;&#x2F;github.com&#x2F;avar&#x2F;dotfiles&#x2F;blob&#x2F;master&#x2F;.bashrc#L381\" rel=\"nofollow\">https:&#x2F;&#x2F;github.com&#x2F;avar&#x2F;dotfiles&#x2F;blob&#x2F;master&#x2F;.bashrc#L381</a><p>And also, and what you asked for, removes any stale symlinks via this\none-liner: <a href=\"https:&#x2F;&#x2F;github.com&#x2F;avar&#x2F;dotfiles&#x2F;blob&#x2F;master&#x2F;.bashrc#L348\" rel=\"nofollow\">https:&#x2F;&#x2F;github.com&#x2F;avar&#x2F;dotfiles&#x2F;blob&#x2F;master&#x2F;.bashrc#L348</a><p>Basically doing a find on my ~ directory and finding any broken links\npointing to the known location of the overlay repo.<p>I see now that there&#x27;s a potential bug in it where it narrows its\nsearch in such a way that it could miss it if you add&#x2F;remove new\n~&#x2F;.??* files. This could be solved, but I have it like that because I\nonly ever add&#x2F;remove stuff in e.g. ~&#x2F;.bashrc.d&#x2F; or ~&#x2F;.screenrc.d&#x2F;, so\nthis way the find takes less time to run.<p>Then I have a generated one-liner that I can paste into new machines\nthat clones my dotfiles.git into ~&#x2F;g&#x2F;, moves the .git to ~&#x2F;, then\nsources bashrc which bootstraps the rest.",
  "time" : 1460982083,
  "type" : "comment"
}
